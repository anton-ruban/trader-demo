<template>
  <div class="trading-chart-panel">
    <div class="head">
      <Tab :tabs="watchDetailTabs" :selectedTabIndex="selectedWatchDetailTabIndex" @change="selectWatchDetailTab($event)"/>
    </div>
    <div class="content">
      <template v-if="selectedWatchDetailTabIndex === 0">
        <Overview />
        <div class="divider"></div>
        <div class="scroll-panel">
          <DeepMarketPrice />
          <div class="divider"></div>
          <div class="chart-section">
            <div class="chart-view">
              <highcharts :constructor-type="'stockChart'" :options="chartOptions" ref="highcharts"></highcharts>
            </div>
          </div>
        </div>
      </template>
      <template v-else-if="selectedWatchDetailTabIndex === 1">
        <div class="chart-section">
          <div class="chart-view">
            <highcharts :constructor-type="'stockChart'" :options="chartOptions" ref="highcharts"></highcharts>
          </div>
        </div>
      </template>
    </div>
  </div>
</template>

<script>
import { mapState } from 'vuex';
import Overview from './Overview.vue';
import DeepMarketPrice from './DeepMarketPrice.vue';
import Tab from '../controls/Tab.vue';

export default {
  name: 'WatchDetailPanel',
  components: {
    Overview,
    DeepMarketPrice,
    Tab
  },
  data() {
    return {
      chartOptions:{
        chart: {
          zoomType: 'x',
          margin: [12, 0, 0, 0],
        },
        yAxis: {
        },
        plotOptions: {
          area: {
              fillColor: {
                  linearGradient: {
                      x1: 0,
                      y1: 0,
                      x2: 0,
                      y2: 1
                  },
                  stops: [
                      [0, 'rgba(51,153,222, 0.5'],
                      [1, 'rgba(255,255,255, 0.5']
                  ]
              },
              marker: {
                  radius: 2
              },
              lineWidth: 2,
              states: {
                  hover: {
                      lineWidth: 2
                  }
              },
              threshold: null
          }
        },
        colorAxis: {
        },
        rangeSelector: {
          selected: 1,
        },
        tooltip: {
            backgroundColor: '#3399dd',
            style: {
                color: '#eee'
            },
            valueDecimals: 2
        },
        series: [{
            type: "area",
            name: 'GLD/CNY',
            data: [
    [
        1515421800000,
        224.35
    ],
    [
        1515508200000,
        224.33
    ],
    [
        1515594600000,
        224.29
    ],
    [
        1515681000000,
        225.28
    ],
    [
        1515767400000,
        227.09
    ],
    [
        1516113000000,
        226.19
    ],
    [
        1516199400000,
        229.1
    ],
    [
        1516285800000,
        229.26
    ],
    [
        1516372200000,
        228.46
    ],
    [
        1516631400000,
        227
    ],
    [
        1516717800000,
        227.04
    ],
    [
        1516804200000,
        224.22
    ],
    [
        1516890600000,
        221.11
    ],
    [
        1516977000000,
        221.51
    ],
    [
        1517236200000,
        227.96
    ],
    [
        1517322600000,
        226.97
    ],
    [
        1517409000000,
        227.43
    ],
    [
        1517495400000,
        227.78
    ],
    [
        1517581800000,
        220.5
    ],
    [
        1517841000000,
        226.49
    ],
    [
        1517927400000,
        223.03
    ],
    [
        1518013800000,
        229.54
    ],
    [
        1518100200000,
        225.15
    ],
    [
        1518186600000,
        226.41
    ],
    [
        1518445800000,
        222.71
    ],
    [
        1518532200000,
        224.34
    ],
    [
        1518618600000,
        227.37
    ],
    [
        1518705000000,
        222.99
    ],
    [
        1518791400000,
        222.43
    ],
    [
        1519137000000,
        221.85
    ],
    [
        1519223400000,
        221.07
    ],
    [
        1519309800000,
        222.5
    ],
    [
        1519396200000,
        225.5
    ],
    [
        1519655400000,
        228.97
    ],
    [
        1519741800000,
        228.39
    ],
    [
        1519828200000,
        228.12
    ],
    [
        1519914600000,
        225
    ],
    [
        1520001000000,
        226.21
    ],
    [
        1520260200000,
        226.82
    ],
    [
        1520346600000,
        226.67
    ],
    [
        1520433000000,
        225.03
    ],
    [
        1520519400000,
        226.94
    ],
    [
        1520605800000,
        229.98
    ],
    [
        1520861400000,
        221.72
    ],
    [
        1520947800000,
        229.97
    ],
    [
        1521034200000,
        228.44
    ],
    [
        1521120600000,
        228.65
    ],
    [
        1521207000000,
        228.02
    ],
    [
        1521466200000,
        225.3
    ],
    [
        1521552600000,
        225.24
    ],
    [
        1521639000000,
        221.27
    ],
    [
        1521725400000,
        228.85
    ],
    [
        1521811800000,
        224.94
    ],
    [
        1522071000000,
        222.77
    ],
    [
        1522157400000,
        228.34
    ],
    [
        1522243800000,
        226.48
    ],
    [
        1522330200000,
        227.78
    ],
    [
        1522675800000,
        226.68
    ],
    [
        1522762200000,
        228.39
    ],
    [
        1522848600000,
        221.61
    ],
    [
        1522935000000,
        222.8
    ],
    [
        1523021400000,
        228.38
    ],
    [
        1523280600000,
        220.05
    ],
    [
        1523367000000,
        223.25
    ],
    [
        1523453400000,
        222.44
    ],
    [
        1523539800000,
        224.14
    ],
    [
        1523626200000,
        224.73
    ],
    [
        1523885400000,
        225.82
    ],
    [
        1523971800000,
        228.24
    ],
    [
        1524058200000,
        227.84
    ],
    [
        1524144600000,
        222.8
    ],
    [
        1524231000000,
        225.72
    ],
    [
        1524490200000,
        225.24
    ],
    [
        1524576600000,
        222.94
    ],
    [
        1524663000000,
        223.65
    ],
    [
        1524749400000,
        224.22
    ],
    [
        1524835800000,
        222.32
    ],
    [
        1525095000000,
        225.26
    ],
    [
        1525181400000,
        229.1
    ],
    [
        1525267800000,
        226.57
    ],
    [
        1525354200000,
        226.89
    ],
    [
        1525440600000,
        223.83
    ],
    [
        1525699800000,
        225.16
    ],
    [
        1525786200000,
        226.05
    ],
    [
        1525872600000,
        227.36
    ],
    [
        1525959000000,
        220.04
    ],
    [
        1526045400000,
        228.59
    ],
    [
        1526304600000,
        228.15
    ],
    [
        1526391000000,
        226.44
    ],
    [
        1526477400000,
        238.18
    ],
    [
        1526563800000,
        226.99
    ],
    [
        1526650200000,
        226.31
    ],
    [
        1526909400000,
        227.63
    ],
    [
        1526995800000,
        227.16
    ],
    [
        1527082200000,
        228.36
    ],
    [
        1527168600000,
        228.15
    ],
    [
        1527255000000,
        228.58
    ],
    [
        1527600600000,
        227.9
    ],
    [
        1527687000000,
        227.5
    ],
    [
        1527773400000,
        226.87
    ],
    [
        1527859800000,
        220.24
    ],
    [
        1528119000000,
        221.83
    ],
    [
        1528205400000,
        223.31
    ],
    [
        1528291800000,
        233.98
    ],
    [
        1528378200000,
        223.46
    ],
    [
        1528464600000,
        231.7
    ],
    [
        1528723800000,
        221.23
    ],
    [
        1528810200000,
        222.28
    ],
    [
        1528896600000,
        220.7
    ],
    [
        1528983000000,
        220.8
    ],
    [
        1529069400000,
        238.84
    ],
    [
        1529328600000,
        238.74
    ],
    [
        1529415000000,
        235.69
    ],
    [
        1529501400000,
        236.5
    ],
    [
        1529587800000,
        235.46
    ],
    [
        1529674200000,
        234.92
    ],
    [
        1529933400000,
        222.17
    ],
    [
        1530019800000,
        224.43
    ],
    [
        1530106200000,
        234.16
    ],
    [
        1530192600000,
        225.5
    ],
    [
        1530279000000,
        225.11
    ],
    [
        1530538200000,
        227.18
    ],
    [
        1530624600000,
        233.92
    ],
    [
        1530797400000,
        235.4
    ],
    [
        1530883800000,
        237.97
    ],
    [
        1531143000000,
        230.58
    ],
    [
        1531229400000,
        230.35
    ],
    [
        1531315800000,
        237.88
    ],
    [
        1531402200000,
        231.03
    ],
    [
        1531488600000,
        231.33
    ],
    [
        1531747800000,
        230.91
    ],
    [
        1531834200000,
        231.45
    ],
    [
        1531920600000,
        230.4
    ],
    [
        1532007000000,
        231.88
    ],
    [
        1532093400000,
        221.44
    ],
    [
        1532352600000,
        221.61
    ],
    [
        1532439000000,
        223
    ],
    [
        1532525400000,
        224.82
    ],
    [
        1532611800000,
        224.21
    ],
    [
        1532698200000,
        220.98
    ],
    [
        1532957400000,
        229.91
    ],
    [
        1533043800000,
        220.29
    ],
    [
        1533130200000,
        241.5
    ],
    [
        1533216600000,
        247.39
    ],
    [
        1533303000000,
        247.99
    ],
    [
        1533562200000,
        239.07
    ],
    [
        1533648600000,
        237.11
    ],
    [
        1533735000000,
        237.25
    ],
    [
        1533821400000,
        238.88
    ],
    [
        1533907800000,
        237.53
    ],
    [
        1534167000000,
        238.87
    ],
    [
        1534253400000,
        239.75
    ],
    [
        1534339800000,
        230.24
    ],
    [
        1534426200000,
        233.32
    ],
    [
        1534512600000,
        237.58
    ],
    [
        1534771800000,
        235.46
    ],
    [
        1534858200000,
        235.04
    ],
    [
        1534944600000,
        235.05
    ],
    [
        1535031000000,
        235.49
    ],
    [
        1535117400000,
        236.16
    ],
    [
        1535376600000,
        218.94
    ],
    [
        1535463000000,
        219.7
    ],
    [
        1535549400000,
        222.98
    ],
    [
        1535635800000,
        225.03
    ],
    [
        1535722200000,
        227.63
    ],
    [
        1536067800000,
        228.36
    ],
    [
        1536154200000,
        226.87
    ],
    [
        1536240600000,
        223.1
    ],
    [
        1536327000000,
        221.3
    ],
    [
        1536586200000,
        218.33
    ],
    [
        1536672600000,
        223.85
    ],
    [
        1536759000000,
        221.07
    ],
    [
        1536845400000,
        226.41
    ],
    [
        1536931800000,
        223.84
    ],
    [
        1537191000000,
        247.88
    ],
    [
        1537277400000,
        218.24
    ],
    [
        1537363800000,
        218.37
    ],
    [
        1537450200000,
        220.03
    ],
    [
        1537536600000,
        219.66
    ],
    [
        1537795800000,
        220.79
    ],
    [
        1537882200000,
        222.19
    ],
    [
        1537968600000,
        220.42
    ],
    [
        1538055000000,
        224.95
    ],
    [
        1538141400000,
        225.74
    ],
    [
        1538400600000,
        227.26
    ],
    [
        1538487000000,
        229.28
    ],
    [
        1538573400000,
        232.07
    ],
    [
        1538659800000,
        227.99
    ],
    [
        1538746200000,
        224.29
    ],
    [
        1539005400000,
        223.77
    ],
    [
        1539091800000,
        226.87
    ],
    [
        1539178200000,
        226.36
    ],
    [
        1539264600000,
        224.45
    ],
    [
        1539351000000,
        222.11
    ],
    [
        1539610200000,
        219.36
    ],
    [
        1539696600000,
        222.15
    ],
    [
        1539783000000,
        221.19
    ],
    [
        1539869400000,
        219.02
    ],
    [
        1539955800000,
        219.31
    ],
    [
        1540215000000,
        220.65
    ],
    [
        1540301400000,
        222.73
    ],
    [
        1540387800000,
        235.09
    ],
    [
        1540474200000,
        219.8
    ],
    [
        1540560600000,
        219.3
    ],
    [
        1540819800000,
        222.24
    ],
    [
        1540906200000,
        219.3
    ],
    [
        1540992600000,
        218.86
    ],
    [
        1541079000000,
        242.22
    ],
    [
        1541165400000,
        233.65
    ],
    [
        1541428200000,
        222.20
    ],
    [
        1541514600000,
        250.00
    ],
    [
        1541601000000,
        249.65
    ],
    [
        1541687400000,
        240.56
    ],
    [
        1541773800000,
        239.66
    ],
    [
        1542033000000,
        238.95
    ],
    [
        1542119400000,
        237.98
    ],
    [
        1542205800000,
        236.96
    ],
    [
        1542292200000,
        235.69
    ],
    [
        1542378600000,
        233.56
    ],
    [
        1542637800000,
        232.15
    ],
    [
        1542724200000,
        231.99
    ],
    [
        1542810600000,
        230.99
    ],
    [
        1542983400000,
        230.56
    ],
    [
        1543242600000,
        240.69
    ],
    [
        1543329000000,
        240.33
    ],
    [
        1543415400000,
        240.22
    ],
    [
        1543501800000,
        244.65
    ],
    [
        1543588200000,
        244.36
    ],
    [
        1543847400000,
        243
    ],
    [
        1543933800000,
        240
    ],
    [
        1544106600000,
        229
    ],
    [
        1544193000000,
        228
    ],
    [
        1544452200000,
        226
    ],
    [
        1544538600000,
        218.96
    ],
    [
        1544625000000,
        220.95
    ],
    [
        1544711400000,
        221.59
    ],
    [
        1544797800000,
        221
    ],
    [
        1545057000000,
        233
    ],
    [
        1545143400000,
        240
    ],
    [
        1545229800000,
        248.56
    ],
    [
        1545316200000,
        219.66
    ],
    [
        1545402600000,
        219.36
    ],
    [
        1545661800000,
        219.22
    ],
    [
        1545834600000,
        229.6
    ],
    [
        1545921000000,
        223.5
    ],
    [
        1546007400000,
        219.68
    ],
    [
        1546266600000,
        220.1
    ],
    [
        1546439400000,
        235
    ],
    [
        1546525800000,
        246.23
    ],
    [
        1546612200000,
        246.22
    ],
    [
        1546871400000,
        218.56
    ],
    [
        1546957800000,
        225
    ],
    [
        1547044200000,
        221
    ],
    [
        1547130600000,
        233.2
    ],
    [
        1547217000000,
        240.63
    ],
    [
        1547476200000,
        250.00
    ],
    [
        1547562600000,
        239.68
    ],
    [
        1547649000000,
        239.65
    ],
    [
        1547735400000,
        239
    ],
    [
        1547821800000,
        225
    ],
    [
        1548167400000,
        220
    ],
    [
        1548253800000,
        248.95
    ],
    [
        1548340200000,
        249.05
    ],
    [
        1548426600000,
        250.00
    ]
],
        }]
      }
    }
  },
  methods: {
    selectWatchDetailTab(e) {
      this.$store.commit('tabs/selectWatchDetailTab', e);
    },
    resizeChart(w) {
      let chart = this.$refs.highcharts.chart;
      chart.setSize(w, 'auto');
    }
  },
  computed: {
    ...mapState('tabs', {
      watchDetailTabs: state => state.watchDetailTabs,
      selectedWatchDetailTabIndex: state => state.selectedWatchDetailTabIndex
    }),
  }
}
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style lang="scss" scoped>
.trading-chart-panel {
  width: 100%;
  height: 100%;
  background-color: #ccc;
  display: flex;
  flex-direction: column;
  .head {
    border: 0;
    background-color: #ccc;
    padding-left: 8px;
    padding-right: 8px;
    height: 32px;
  }
  .content {
    margin: 8px;
    margin-top: 0;
    height: calc(100% - 40px);
    display: flex;
    flex-direction: column;
    .divider {
      margin-top: 8px;
    }
    .scroll-panel {
      flex: 1 1 auto;
      overflow: auto;
    }
    .chart-section {
      position: relative;
      .chart-view {
        position: absolute;
        width: 100%;
      }
    }
  }
}
</style>
